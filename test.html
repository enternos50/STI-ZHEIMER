<!DOCTYPE html>
<html lang="fr">
<head>
  <link rel="stylesheet" href="jeu.css">
  <meta charset="UTF-8">
  <title>Quiz STI-ZHEIMER</title>
  
   
</head>
<body>

  
  
  <button class="btn-accueil" onclick="allerAccueil()">üè† Accueil</button>
</div>



  <div id="quiz">
    <div id="joueurActuel"></div>
    <div class="question" id="question-text"></div>
    <div id="reponses"></div>
    <div id="progress-container" style="width: 100%; background-color: #ede4e4; height: 20px; border-radius: 10px; overflow: hidden; margin-bottom: 10px;">
  <div id="progress-bar" style="height: 100%; width: 100%; background-color: darkorange; transition: width 1s linear;"></div>
</div>
    <div id="timer" style="font-weight: bold; font-size: 1.2em; color: darkorange;"></div>
    <div id="resultat"></div>
  </div>

  <aside id="scoreSidebar">
    <h2>Scores</h2>
    <div id="joueursInfos"></div>
  </aside>

  <script>

    function melanger(array) {
  return array.sort(() => 0.5 - Math.random());
}


    const niveauQuiz = localStorage.getItem("niveauQuiz") || "Mixte";

    // Questions du quiz
    const toutesLesQuestions = [
      {
  question: "Combien font 2 + 2 ?",
  reponses: ["3", "4", "5", "6"],
  bonne: "4",
  niveau: "Facile",
  motCle:"coucou",
},
{
  question: "Quel fruit est jaune et courb√© ?",
  reponses: ["Pomme", "Citron", "Banane", "Poire"],
  bonne: "Banane",
  niveau: "Facile",
   motCle:"coucou",
},
{
  question: "Quel est le contraire de jour ?",
  reponses: ["Soir", "Matin", "Nuit", "Midi"],
  bonne: "Nuit",
  niveau: "Facile",
   motCle:"coucou",
},
{
  question: "Quel est le cinqui√®me mois de l'ann√©e ?",
  reponses: ["Mars", "Mai", "Avril", "Juin"],
  bonne: "Mai",
  niveau: "Facile",
   motCle:"coucou",
},
{
  question: "Quel animal miaule ?",
  reponses: ["Chien", "Chat", "Cheval", "Oiseau"],
  bonne: "Chat",
  niveau: "Facile",
   motCle:"coucou",
},

  {
  question: "Combien y a-t-il de continents sur Terre ?",
  reponses: ["5", "6", "7", "8"],
  bonne: "7",
  niveau: "Facile",
   motCle:"coucou",
},
{
  question: "Quel est l'animal symbole de la France ?",
  reponses: ["Lion", "Coq", "Aigle", "Cheval"],
  bonne: "Coq",
  niveau: "Facile",
   motCle:"coucou",
},
{
  question: "Quelle est la couleur du sang ?",
  reponses: ["Bleu", "Rouge", "Vert", "Noir"],
  bonne: "Rouge",
  niveau: "Facile",
   motCle:"coucou",
},
{
  question: "Quel est le plus grand oc√©an du monde ?",
  reponses: ["Atlantique", "Indien", "Pacifique", "Arctique"],
  bonne: "Pacifique",
  niveau: "Facile",
   motCle:"coucou",
},
{
  question: "Dans quel pays se trouve la tour Eiffel ?",
  reponses: ["Italie", "Espagne", "Allemagne", "France"],
  bonne: "France",
  niveau: "Facile",
   motCle:"coucou",
}

  ,
  {
  question: "Combien de c√¥t√©s a un hexagone ?",
  reponses: ["5", "6", "7", "8"],
  bonne: "6",
  niveau: "Moyen",
   motCle:"coucou",
},
{
  question: "Quelle est la langue officielle du Br√©sil ?",
  reponses: ["Espagnol", "Portugais", "Fran√ßais", "Anglais"],
  bonne: "Portugais",
  niveau: "Moyen",
   motCle:"coucou",
},
{
  question: "Qui a √©crit 'Le Petit Prince' ?",
  reponses: ["Victor Hugo", "Saint-Exup√©ry", "Jules Verne", "Zola"],
  bonne: "Saint-Exup√©ry",
  niveau: "Moyen",
   motCle:"coucou",
},
{
  question: "Quelle est la capitale de l‚ÄôAustralie ?",
  reponses: ["Sydney", "Melbourne", "Canberra", "Brisbane"],
  bonne: "Canberra",
  niveau: "Moyen",
   motCle:"coucou",
},
{
  question: "Combien y a-t-il de z√©ros dans un million ?",
  reponses: ["3", "4", "5", "6"],
  bonne: "6",
  niveau: "Moyen",
   motCle:"coucou",
},

 {
  question: "Qui a peint la Joconde ?",
  reponses: ["Picasso", "Michel-Ange", "L√©onard de Vinci", "Monet"],
  bonne: "L√©onard de Vinci",
  niveau: "Moyen",
   motCle:"coucou",
},
{
  question: "Quelle plan√®te est la plus proche du Soleil ?",
  reponses: ["Mars", "V√©nus", "Mercure", "Terre"],
  bonne: "Mercure",
  niveau: "Moyen",
   motCle:"coucou",
},
{
  question: "Quel est l‚Äôauteur de ¬´ Les Mis√©rables ¬ª ?",
  reponses: ["Victor Hugo", "Moli√®re", "Voltaire", "√âmile Zola"],
  bonne: "Victor Hugo",
  niveau: "Moyen",
   motCle:"coucou",
},
{
  question: "Quelle est la capitale du Canada ?",
  reponses: ["Toronto", "Vancouver", "Ottawa", "Montr√©al"],
  bonne: "Ottawa",
  niveau: "Moyen",
   motCle:"coucou",
},
{
  question: "Combien y a-t-il de joueurs dans une √©quipe de football ?",
  reponses: ["9", "10", "11", "12"],
  bonne: "11",
  niveau: "Moyen",
   motCle:"coucou",
}
,
 {
  question: "Quel est l‚Äô√©l√©ment chimique dont le symbole est 'Fe' ?",
  reponses: ["Fluor", "Fer", "Francium", "Phosphore"],
  bonne: "Fer",
  niveau: "Difficile",
   motCle:"coucou",
},
{
  question: "Dans quelle ville se trouve le mus√©e du Prado ?",
  reponses: ["Rome", "Madrid", "Paris", "Lisbonne"],
  bonne: "Madrid",
  niveau: "Difficile",
   motCle:"coucou",
},
{
  question: "Quel pays a invent√© les Jeux Olympiques ?",
  reponses: ["Italie", "Gr√®ce", "France", "Chine"],
  bonne: "Gr√®ce",
  niveau: "Difficile",
   motCle:"coucou",
},
{
  question: "En quelle ann√©e a eu lieu le premier pas sur la Lune ?",
  reponses: ["1965", "1969", "1972", "1959"],
  bonne: "1969",
  niveau: "Difficile",
   motCle:"coucou",
},
{
  question: "Quel est le plus long fleuve du monde ?",
  reponses: ["Amazone", "Nil", "Mississippi", "Yangts√©"],
  bonne: "Amazone",
  niveau: "Difficile",
   motCle:"coucou",
},
{
  question: "Quel est l'inventeur du t√©l√©phone ?",
  reponses: ["Edison", "Bell", "Tesla", "Newton"],
  bonne: "Bell",
  niveau: "Difficile",
   motCle:"coucou",
},
{
  question: "Quel est l'acide contenu dans l'estomac humain ?",
  reponses: ["Acide sulfurique", "Acide citrique", "Acide chlorhydrique", "Acide ac√©tique"],
  bonne: "Acide chlorhydrique",
  niveau: "Difficile",
   motCle:"coucou",
},
{
  question: "Quelle est la langue la plus parl√©e au monde ?",
  reponses: ["Anglais", "Espagnol", "Arabe", "Chinois mandarin"],
  bonne: "Chinois mandarin",
  niveau: "Difficile",
   motCle:"coucou",
},
{
  question: "Quel scientifique a propos√© la th√©orie de la relativit√© ?",
  reponses: ["Einstein", "Galil√©e", "Bohr", "Newton"],
  bonne: "Einstein",
  niveau: "Difficile",
   motCle:"coucou",
},
{
  question: "Quel pays a la plus grande superficie au monde ?",
  reponses: ["Canada", "Chine", "√âtats-Unis", "Russie"],
  bonne: "Russie",
  niveau: "Difficile",
   motCle:"coucou",
},


];



let timerInterval;
let tempsRestant = 15; // secondes par question

// Fonction pour tirer X questions al√©atoires de chaque niveau
function tirerQuestionsSelonNiveau() {
  const faciles = toutesLesQuestions.filter(q => q.niveau === "Facile");
  const moyens = toutesLesQuestions.filter(q => q.niveau === "Moyen");
  const difficiles = toutesLesQuestions.filter(q => q.niveau === "Difficile");

  if (niveauQuiz === "Facile") {
    return faciles.sort(() => 0.5 - Math.random()).slice(0, 10);
  } else if (niveauQuiz === "Moyen") {
    return moyens.sort(() => 0.5 - Math.random()).slice(0, 10);
  } else if (niveauQuiz === "Difficile") {
    return difficiles.sort(() => 0.5 - Math.random()).slice(0, 10);
  } else {
    // Mixte : 4 faciles + 4 moyens + 2 difficiles
    function tirer(questions, count) {
      return [...questions].sort(() => 0.5 - Math.random()).slice(0, count);
    }

    return [
      ...tirer(faciles, 4),
      ...tirer(moyens, 4),
      ...tirer(difficiles, 2)
    ];
  }
}

const questions = tirerQuestionsSelonNiveau();




    // R√©cup√®re les joueurs depuis la page pr√©c√©dente
    const joueurs = JSON.parse(localStorage.getItem("joueurs") || "[]");
    joueurs.forEach(j => j.score = 0); // initialise les scores

    const joueursInfosDiv = document.getElementById("joueursInfos");
    joueurs.forEach(joueur => {
      const p = document.createElement("p");
      p.className = "joueur";
      joueursInfosDiv.appendChild(p);
    });

    let questionIndex = 0;
    let joueurIndex = 0;

  function afficherScores() {
  const joueursInfosDiv = document.getElementById("joueursInfos");
  joueursInfosDiv.innerHTML = ""; // vide avant de remplir

 joueurs.forEach(joueur => {
  const p = document.createElement("p");
  p.className = "joueur";
  p.style.color = joueur.couleur;
  p.id = `score-${joueur.nom.replace(/\s+/g, '')}`; // identifiant unique par joueur
  p.textContent = `${joueur.nom} : ${joueur.score} point(s)`;
  joueursInfosDiv.appendChild(p);
});

}


  function afficherQuestion() {
  
  afficherScores();

  const quiz = document.getElementById("quiz");
  quiz.classList.remove("fade-in");
  quiz.classList.add("fade-out");

  setTimeout(() => {
    if (questionIndex >= questions.length) {
      afficherScoresFinaux();
      return;
    }

    const joueur = joueurs[joueurIndex];
    const q = questions[questionIndex];

    document.getElementById("joueurActuel").innerHTML = 
      `C'est √† <strong style="color:${joueur.couleur}">${joueur.nom}</strong> de r√©pondre.`;

    document.getElementById("question-text").innerHTML = 
      `${q.question} <span style="font-size:0.8em;color:gray;">[${q.niveau}]</span>`;

    const reponsesDiv = document.getElementById("reponses");
    reponsesDiv.innerHTML = "";

    const reponsesMelangees = melanger([...q.reponses]);
    reponsesMelangees.forEach(rep => {
      const btn = document.createElement("div");
      btn.className = "reponse";
      btn.textContent = rep;
      btn.onclick = () => verifier(rep);  // ici on ajoute l‚Äôevent click
      reponsesDiv.appendChild(btn);
    });

    document.getElementById("resultat").textContent = "";

    // D√©marre le timer
    tempsRestant = 15;
    document.getElementById("timer").textContent = `Temps restant : ${tempsRestant} sec`;
    document.getElementById("progress-bar").style.width = "100%";

    clearInterval(timerInterval); // stoppe le timer pr√©c√©dent

    quiz.classList.remove("fade-out");
    quiz.classList.add("fade-in");

    timerInterval = setInterval(() => {
      tempsRestant--;
      document.getElementById("timer").textContent = `Temps restant : ${tempsRestant} sec`;

      // Met √† jour la barre de progression
      const pourcentage = (tempsRestant / 15) * 100;
      const progressBar = document.getElementById("progress-bar");
      progressBar.style.width = `${pourcentage}%`;

      if (tempsRestant <= 5) {
        progressBar.style.backgroundColor = "red";
      } else if (tempsRestant <= 10) {
        progressBar.style.backgroundColor = "orange";
      } else {
        progressBar.style.backgroundColor = "green";
      }

      if (tempsRestant <= 0) {
        clearInterval(timerInterval);
        verifier(null); // Temps √©coul√© = pas de r√©ponse
      }
    }, 1000);

  }, 300);
}

function verifier(reponse) {
  clearInterval(timerInterval); // Arr√™te le timer

  // D√©sactive tous les boutons r√©ponses pour emp√™cher plusieurs clics
  document.querySelectorAll(".reponse").forEach(btn => {
    btn.onclick = null;
  });

  const questionActuelle = questions[questionIndex];
  const bonne = questionActuelle.bonne;
  const joueur = joueurs[joueurIndex];
  const resultat = document.getElementById("resultat");

  if (reponse === bonne) {
    joueur.score++;
    resultat.innerHTML = `Bonne r√©ponse ! ‚úÖ<br>Indice : <strong>${questionActuelle.motCle}</strong>`;
    resultat.style.color = "green";
    document.getElementById(`score-${joueur.nom.replace(/\s+/g, '')}`).textContent = `${joueur.nom} : ${joueur.score} point(s)`;
    
  } else if (reponse === null) {
    resultat.textContent = `‚è±Ô∏è Temps √©coul√© ! La bonne r√©ponse √©tait : ${bonne}`;
    resultat.style.color = "orange";
  } else {
    resultat.textContent = `Mauvaise r√©ponse ‚ùå La bonne r√©ponse √©tait : ${bonne}`;
    resultat.style.color = "red";
  }

  questionIndex++;
  joueurIndex = (joueurIndex + 1) % joueurs.length;

  setTimeout(afficherQuestion, 5000);
}



  function afficherScoresFinaux() {
  clearInterval(timerInterval);

  const quizDiv = document.getElementById("quiz");

  quizDiv.innerHTML = `
    <h2>Quiz termin√© !</h2>
    <ul>
      ${joueurs.map(j =>
        `<li><span style="color:${j.couleur}">${j.nom}</span> : ${j.score} point(s)</li>`
      ).join("")}
    </ul>
    <div style="margin-top: 20px;">
      <button id="btnRejouer">üîÅ Rejouer avec les m√™mes joueurs</button>
      <button id="btnAccueil">üè† Accueil</button>
    </div>
  `;

  // üîÅ Ajouter les √©couteurs apr√®s injection HTML
  const btnRejouer = document.getElementById("btnRejouer");
  const btnAccueil = document.getElementById("btnAccueil");

  if (btnRejouer) btnRejouer.addEventListener("click", rejouer);
  if (btnAccueil) btnAccueil.addEventListener("click", allerAccueil);
}



function rejouer() {
  // Reset et relance du quiz avec les m√™mes joueurs
  questionsPosees = [];
  joueurs.forEach(j => j.score = 0);
  joueurActuelIndex = 0;
  afficherQuestion();
}

function allerAccueil() {
  // Redirection vers la page d'accueil
  window.location.href = "index.html"; // ou change selon ton fichier
}




    afficherQuestion();

    

  </script>

</body>
</html>
